<app-menu></app-menu>

<h2>Athlete Management</h2>

<div class="athlete-management">
    <app-selection-wrapper
        [formControl]="selectedAthletes"
        [template]="athleteTemplate"
        [dataItems]="allAthletes | async" >
        <ng-template #athleteTemplate let-dataItem="dataItem">
            <div>
                <app-athlete
                    [athlete]="dataItem"
                    [small]="true"
                ></app-athlete>
                <app-base-workout-info [baseWorkout]="dataItem.baseWorkout"></app-base-workout-info>
                Current Permissions: {{dataItem.permissions | json}}
            </div>
        </ng-template>
    </app-selection-wrapper>

    <div>
        <app-input [fc]="form.get('distance')" [label]="'Distance ' + (form.value.distance | distance)"></app-input>
        <app-input [fc]="form.get('average_speed')" [label]="'Pace ' + (form.value.average_speed | pace)"></app-input>
    </div>

    <app-button [disabled]="!selectedAthletes.value.length || form.invalid" (click)="updateBaseWorkout()" [label]="'Set Base Workout'"></app-button>

    <app-selection-wrapper
        [formControl]="selectedPermissions"
        [template]="permissionTemplate"
        [dataItems]="PERMISSIONS | keyvalue"
        [idKey]="'value'"
    >
        <ng-template #permissionTemplate let-dataItem="dataItem">
            <div>
                {{dataItem.value}}
            </div>
        </ng-template>
    </app-selection-wrapper>

    <app-button [disabled]="!selectedAthletes.value.length || !selectedPermissions.value.length" (click)="setPermissions()" [label]="'Set Permissions'"></app-button>
</div>
